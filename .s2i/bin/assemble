#!/bin/bash -e

# restore build artifacts
if [ "$(ls /tmp/s2i/artifacts/ 2>/dev/null)" ]; then
    mv /tmp/s2i/artifacts/* $HOME/.
fi

# move the application source
mv /tmp/s2i/src $HOME/src

pushd $HOME/src
mvn clean package -Pdev -Dmaven.test.skip=true
popd

mv $HOME/src/target/heroes-api-1.0.0.jar $HOME/heroes-api/
rm -rf $HOME/src